SELECT   distinct Count(ca.firstname + ' '+ ca.lastname) AS CustomerCount, dbo.fn_GetReportingCategory('1') as Category1, dbo.fn_GetReportingCategory('2') as Category2, dbo.fn_GetReportingCategory('3') as Category3, dbo.fn_GetReportingCategory('4') as Category4, dbo.fn_GetReportingCategory('5') as Category5, dbo.fn_GetReportingBrand('1') as Brand1, dbo.fn_GetReportingBrand('2') as Brand2, dbo.fn_GetReportingBrand('3') as Brand3, dbo.fn_GetReportingBrand('4') as Brand4, dbo.fn_GetReportingBrand('5') as Brand5  FROM    CUSTOMER AS c INNER JOIN [User] AS u ON u.UserID = c.UserID INNER JOIN Contact AS ca ON ca.UserID = c.UserID LEFT JOIN User_Relation ur ON ur.ChildUserID =  c.UserID LEFT JOIN View_CustomerBeer AS d1 ON d1.CustomerUserID = u.UserID LEFT JOIN View_CustomerPremixed AS d2 ON d2.CustomerUserID = u.UserID LEFT JOIN View_CustomerWhite AS d3 ON d3.CustomerUserID = u.UserID LEFT JOIN View_CustomerSparkling AS d4 ON d4.CustomerUserID = u.UserID LEFT JOIN View_CustomerRed AS d5 ON d5.CustomerUserID = u.UserID LEFT JOIN View_CustomerSpirits AS d6 ON d6.CustomerUserID = u.UserID LEFT JOIN View_CustomerCider AS d7 ON d7.CustomerUserID = u.UserID LEFT JOIN View_CustomerHotels AS ch ON ch.UserID = u.UserID  LEFT JOIN  dbo.RedeemedItems AS R ON  r.UserMobileNumber  =ca.mobile   LEFT JOIN dbo.Campaign_Item AS ci ON ci.targetid = r.targetid     LEFT JOIN dbo.Schedule AS s ON s.id = ci.scheduleid   LEFT JOIN Target_Item AS ti ON ti.TargetID=ci.targetid   LEFT JOIN Target_Item_Type ON Target_Item_Type.ID=ti.TargetItemTypeID  WHERE  u.Deleted='false'   AND R.DrinkCategoryId<>'' AND R.SubBrandId<>'' 